# {{ ansible_managed | default('Managed by Ansible') }}
# Syslog Server Configuration
# Receives logs from remote hosts

# Template for remote logs - organize by hostname
template(name="RemoteLogs" type="string"
         string="{{ syslog_remote_log_dir | default('/var/log/remote') }}/%HOSTNAME%/%PROGRAMNAME%.log")

# Template for unified remote log
template(name="RemoteLogsUnified" type="string"
         string="{{ syslog_remote_log_dir | default('/var/log/remote') }}/%HOSTNAME%/all.log")

# Store remote logs by hostname and program
if $fromhost-ip != "127.0.0.1" then {
    action(type="omfile" dynaFile="RemoteLogs" FileCreateMode="0640" DirCreateMode="0755")
    action(type="omfile" dynaFile="RemoteLogsUnified" FileCreateMode="0640" DirCreateMode="0755")
    stop
}
